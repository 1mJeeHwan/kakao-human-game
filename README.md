# 인간 키우기 게임

카카오톡 챗봇 기반 인간 육성 시뮬레이션 게임

## 라이브 서버

- **API**: https://kakao-human-game.onrender.com
- **게임 정보**: https://kakao-human-game.onrender.com/game/info
- **도움말**: https://kakao-human-game.onrender.com/game/help

---

## 게임 소개

랜덤 칭호 + 직업 조합으로 캐릭터를 생성하고, 성장시켜 판매하는 게임입니다.

### 조합 예시
```
"소심한 +0 수습 백수"
"천재적인 +7 숙련 개발자"
"전설의 +15 그랜드마스터 용사"
```

---

## 핵심 기능

### 1. 성장 시스템
- **성공**: 레벨 +1
- **실패**: 레벨 유지 (3% 확률로 직업 상실)
- **사망**: 캐릭터 초기화 + 파괴 지원금

### 2. 칭호 시스템 (65개)
| 등급 | 확률 | 판매 보너스 | 특수 능력 |
|------|------|-------------|-----------|
| 일반 | 40% | +0% | - |
| 고급 | 30% | +10% | - |
| 희귀 | 20% | +25% | 일부 보유 |
| 영웅 | 8% | +50% | 일부 보유 |
| 전설 | 2% | +100% | 전부 보유 |

#### 특수 능력 종류
- **사망 방지**: 사망 1회 무효화
- **행운 증가**: 성공률 +5%
- **비용 할인**: 강화 비용 50% 할인
- **판매가 2배**: 판매 시 가격 2배
- **잭팟 확률 2배**: 파괴 지원금 잭팟 확률 증가
- **추가 골드**: 판매 시 보너스 골드
- **실패→성공**: 실패를 성공으로 변환 (1회)
- **지원금 2배**: 파괴 지원금 2배

### 3. 직업 시스템 (46개)
| 등급 | 확률 | 판매 보너스 |
|------|------|-------------|
| 일반 | 50% | +0% |
| 고급 | 30% | +15% |
| 희귀 | 15% | +30% |
| 전설 | 5% | +60% |

#### 직업 수식어 (레벨별)
| 레벨 | 수식어 |
|------|--------|
| 0 | 수습 |
| 1-3 | 견습 |
| 4-6 | (없음) |
| 7-9 | 숙련 |
| 10-12 | 베테랑 |
| 13-14 | 마스터 |
| 15 | 그랜드마스터 |

### 4. 직업 상실 시스템
- 성장 실패 시 **3% 확률**로 백수가 됨
- 직업별 해고 메시지 출력

### 5. 파괴 지원금 (사망 시)
| 환급률 | 확률 |
|--------|------|
| 0% | 13.9% |
| 50% | 50% |
| 70% | 30% |
| 90% | 5% |
| 100% | 1% |
| **200% (잭팟)** | 0.1% |

### 6. 도감 시스템
- 획득한 칭호/직업 수집
- 완성 보상:
  - 칭호 도감: 100,000G
  - 직업 도감: 150,000G
  - 전체 도감: 500,000G

---

## 성장 확률표

| 레벨 | 성공 | 실패 | 사망 | 비용 | 판매가 |
|------|------|------|------|------|--------|
| 0→1 | 98% | 1% | 1% | 20G | 200G |
| 1→2 | 96% | 2% | 2% | 50G | 400G |
| 2→3 | 93% | 4% | 3% | 100G | 800G |
| 3→4 | 89% | 6% | 5% | 200G | 1,600G |
| 4→5 | 84% | 9% | 7% | 500G | 3,200G |
| 5→6 | 75% | 15% | 10% | 1,000G | 6,400G |
| 6→7 | 65% | 20% | 15% | 3,000G | 25,600G |
| 7→8 | 55% | 25% | 20% | 10,000G | 102,400G |
| 8→9 | 45% | 30% | 25% | 30,000G | 409,600G |
| 9→10 | 35% | 35% | 30% | 100,000G | 1,638,400G |
| 10→11 | 25% | 35% | 40% | 300,000G | 6,553,600G |
| 11→12 | 18% | 32% | 50% | 1,000,000G | 26,214,400G |
| 12→13 | 12% | 28% | 60% | 3,000,000G | 104,857,600G |
| 13→14 | 7% | 23% | 70% | 10,000,000G | 419,430,400G |
| 14→15 | 3% | 17% | 80% | 30,000,000G | 1,677,721,600G |

---

## 명령어

| 명령어 | 설명 |
|--------|------|
| 시작 | 게임 시작 / 내 정보 확인 |
| 성장 | 인간 성장시키기 |
| 판매 | 인간 판매하기 |
| 확률 | 성장 확률표 보기 |
| 도감 | 칭호/직업 수집 현황 |
| 보상 | 도감 완성 보상 받기 |
| 기록 | 플레이 통계 보기 |
| 업데이트 | 패치 노트 보기 |
| 도움말 | 명령어 안내 |

---

## 기술 스택

- **Backend**: Node.js + Express.js
- **Database**: MongoDB Atlas
- **Hosting**: Render.com
- **Uptime**: UptimeRobot (5분 ping)
- **Images**: 46개 직업별 AI 생성 이미지

---

## 프로젝트 구조

```
kakao_game_1/
├── server.js              # Express 서버
├── config/
│   └── database.js        # MongoDB 연결
├── models/
│   └── User.js            # 유저 스키마
├── routes/
│   └── game.js            # API 라우터 + 웹페이지
├── controllers/
│   └── gameController.js  # 게임 로직
├── utils/
│   ├── titles.js          # 칭호 데이터 (65개 + 특수능력)
│   ├── jobs.js            # 직업 데이터 (46개 + 상실 시스템)
│   ├── images.js          # 이미지 URL 생성
│   ├── jobImages.js       # 정적 이미지 관리
│   ├── deathMessages.js   # 사망/환급 메시지
│   ├── gameConfig.js      # 성장 확률 테이블
│   └── helpers.js         # 헬퍼 함수
├── public/
│   ├── css/
│   │   └── job-cards.css  # 등급별 CSS 스타일
│   └── images/
│       └── jobs/          # 46개 직업 이미지
└── docs/
    ├── GEMINI_BATCH_PROMPTS.md   # 이미지 생성 프롬프트
    └── GEMINI_IMAGE_PROMPTS.md   # 상세 프롬프트
```

---

## API 엔드포인트

| Method | Endpoint | 설명 |
|--------|----------|------|
| POST | /game/start | 게임 시작 / 상태 조회 |
| POST | /game/upgrade | 인간 성장 |
| POST | /game/sell | 인간 판매 |
| POST | /game/rates | 확률표 조회 |
| POST | /game/collection | 도감 조회 |
| POST | /game/reward | 도감 보상 수령 |
| POST | /game/updates | 업데이트 공지 |
| POST | /game/stats | 통계 조회 |
| POST | /game/help | 도움말 (챗봇) |
| GET | /game/info | 게임 정보 웹페이지 |
| GET | /game/help | 도움말 웹페이지 |

### 요청 형식 (카카오 오픈빌더)
```json
{
  "userRequest": {
    "user": {
      "id": "카카오유저ID"
    }
  }
}
```

---

## 로컬 개발

### 1. 설치
```bash
npm install
```

### 2. 환경 변수
```bash
cp .env.example .env
```

`.env` 파일 수정:
```env
MONGODB_URI=mongodb+srv://...
PORT=3000
NODE_ENV=development
USE_STATIC_IMAGES=true
JOB_IMAGE_BASE_URL=/images/jobs/
```

### 3. 실행
```bash
npm run dev   # 개발 모드
npm start     # 프로덕션 모드
```

---

## 카카오 오픈빌더 설정

### 스킬 등록 (9개)

| 스킬명 | URL | 발화 |
|--------|-----|------|
| 게임시작 | /game/start | 시작, 내정보 |
| 성장하기 | /game/upgrade | 성장 |
| 판매하기 | /game/sell | 판매 |
| 확률표 | /game/rates | 확률 |
| 도감 | /game/collection | 도감 |
| 보상받기 | /game/reward | 보상 |
| 업데이트 | /game/updates | 업데이트 |
| 기록 | /game/stats | 기록 |
| 도움말 | /game/help | 도움말, 명령어 |

---

## 이미지 시스템

### 정적 이미지
- 46개 직업별 AI 생성 이미지 (Gemini)
- 위치: `/public/images/jobs/`
- 프롬프트: `/docs/GEMINI_BATCH_PROMPTS.md`

### 등급별 CSS 테두리
| 등급 | 스타일 |
|------|--------|
| 일반 | 회색 테두리 |
| 고급 | 초록 + 발광 |
| 희귀 | 파랑 + 애니메이션 |
| 전설 | 금색 + 반짝임 |

---

## 라이선스

MIT License
