# 인간 키우기 게임

카카오톡 챗봇 기반의 인간 육성 게임입니다.

## 게임 설명

- 랜덤 칭호 + 직업 조합으로 유니크한 캐릭터 생성
- 성장 시스템으로 레벨업 (성공/실패/사망)
- 성장 성공 시 랜덤으로 칭호/직업 변경 가능
- 수식어에 따른 판매 보너스
- 7강부터 고위험 고보상 시스템

### 조합 예시
```
"소심한 +0 수습 백수"
"천재적인 +7 숙련 개발자"
"전설의 +15 그랜드마스터 용사"
```

## 라이브 서버

**API**: https://kakao-human-game.onrender.com

## 시작하기

### 1. 의존성 설치
```bash
npm install
```

### 2. 환경 변수 설정
```bash
cp .env.example .env
```

`.env` 파일을 열고 MongoDB URI를 설정합니다:
```env
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/human-game
PORT=3000
NODE_ENV=development
```

### 3. 서버 실행
```bash
# 개발 모드 (자동 재시작)
npm run dev

# 프로덕션 모드
npm start
```

### 4. 테스트
```bash
npm test
```

## API 엔드포인트

| 엔드포인트 | 설명 |
|-----------|------|
| POST /game/start | 게임 시작 / 상태 조회 |
| POST /game/upgrade | 인간 성장 |
| POST /game/sell | 인간 판매 |
| POST /game/rates | 확률표 조회 |
| POST /game/collection | 도감 조회 |
| POST /game/reward | 도감 보상 수령 |
| POST /game/updates | 업데이트 공지 |
| POST /game/stats | 통계 조회 |

### 요청 형식 (카카오 오픈빌더)
```json
{
  "userRequest": {
    "user": {
      "id": "카카오유저ID"
    }
  }
}
```

## 프로젝트 구조

```
kakao_game_1/
├── server.js              # 메인 서버
├── package.json
├── .env.example
├── config/
│   └── database.js       # MongoDB 연결
├── models/
│   └── User.js           # 유저 스키마
├── routes/
│   └── game.js           # API 라우터
├── controllers/
│   └── gameController.js # 게임 로직
├── utils/
│   ├── titles.js         # 칭호 데이터
│   ├── jobs.js           # 직업 데이터
│   ├── images.js         # 이미지 URL 생성
│   ├── gameConfig.js     # 성장 확률 테이블
│   └── helpers.js        # 헬퍼 함수
└── tests/
    └── game.test.js      # 테스트
```

## 게임 밸런스

### 초기 설정
- 시작 골드: **5,000G**
- 최대 레벨: **+15**

### 칭호 확률
| 등급 | 확률 | 판매 보너스 |
|------|------|-------------|
| 일반 | 40% | +0% |
| 고급 | 30% | +10% |
| 희귀 | 20% | +25% |
| 영웅 | 8% | +50% |
| 전설 | 2% | +100% |

### 직업 확률
| 등급 | 확률 | 판매 보너스 |
|------|------|-------------|
| 일반 | 50% | +0% |
| 고급 | 30% | +15% |
| 희귀 | 15% | +30% |
| 전설 | 5% | +60% |

### 성장 확률 (7강부터 지옥)
| 레벨 | 성공 | 사망 | 실패 | 비용 |
|------|------|------|------|------|
| 0→1 | 100% | 0% | 0% | 200G |
| 1→2 | 90% | 0% | 10% | 400G |
| 2→3 | 80% | 0% | 20% | 600G |
| 3→4 | 70% | 5% | 25% | 1,000G |
| 4→5 | 60% | 10% | 30% | 1,800G |
| 5→6 | 50% | 15% | 35% | 3,500G |
| 6→7 | 40% | 20% | 40% | 6,000G |
| **7→8** | **30%** | **35%** | 35% | 10,000G |
| 8→9 | 25% | 45% | 30% | 18,000G |
| 9→10 | 20% | 55% | 25% | 30,000G |
| 10→11 | 15% | 60% | 25% | 50,000G |
| 11→12 | 10% | 65% | 25% | 80,000G |
| 12→13 | 7% | 70% | 23% | 130,000G |
| 13→14 | 4% | 76% | 20% | 200,000G |
| 14→15 | 2% | 83% | 15% | 350,000G |

### 판매가 (7강부터 2배씩 증가)
| 레벨 | 기본 판매가 |
|------|-------------|
| +1 | 200G |
| +3 | 800G |
| +5 | 3,200G |
| +6 | 6,400G |
| **+7** | **25,600G** (2배) |
| **+8** | **102,400G** (4배) |
| **+9** | **409,600G** (8배) |
| **+10** | **3,276,800G** (16배) |

### 성장 성공 시 변이
- 칭호 변경 확률: 20%
- 직업 변경 확률: 15%

### 파괴 지원금 (10강 이후 사망 시)
| 환급률 | 확률 |
|--------|------|
| 50% | 50% |
| 70% | 30% |
| 90% | 5% |
| 100% | 1% |
| **200% (잭팟!)** | 0.1% |
| 없음 | 13.9% |

### 도감 시스템
- 획득한 칭호/직업 수집
- 도감 완성 보상:
  - 칭호 도감 완성: 100,000G
  - 직업 도감 완성: 150,000G
  - 전체 도감 완성: 500,000G

## 이미지 시스템

DiceBear API를 사용한 픽셀 아트 아바타 자동 생성
- 레벨에 따른 이미지 변화
- 등급에 따른 배경색 변화
- 고레벨(13+): 금빛 배경

## 배포

### Render.com
1. GitHub 연동
2. New Web Service 생성
3. 환경 변수 설정 (MONGODB_URI)
4. Start Command: `npm start`
5. 배포

### 카카오 오픈빌더
1. 카카오톡 채널 생성
2. 오픈빌더에서 봇 생성
3. 스킬 8개 등록:
   - 게임시작: `/game/start` (발화: 시작, 내정보)
   - 성장하기: `/game/upgrade` (발화: 성장)
   - 판매하기: `/game/sell` (발화: 판매)
   - 확률표: `/game/rates` (발화: 확률)
   - 도감: `/game/collection` (발화: 도감)
   - 보상받기: `/game/reward` (발화: 보상)
   - 업데이트: `/game/updates` (발화: 업데이트)
   - 기록: `/game/stats` (발화: 기록)
4. 블록 생성 및 스킬 연결
5. 배포

## 라이선스

MIT License
